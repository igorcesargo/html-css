<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ayla Adventure - Vers√£o Final Mobile</title>
    <style>
        /* Impede que a tela balance ou d√™ zoom */
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; padding: 0; overflow: hidden; background: #87CEEB; font-family: 'Comic Sans MS', sans-serif; touch-action: none; }

        /* O container do jogo agora ocupa a tela toda */
        #game-container {
            width: 100vw;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }

        #world { position: absolute; top: 0; left: 0; width: 1000000px; height: 100%; }

        #parallax-bg {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('imagens/fundo.png');
            background-size: auto 100%; background-repeat: repeat-x;
        }

        #ground {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 80px;
            background-image: url('imagens/chao.png');
            background-size: contain; background-repeat: repeat-x; z-index: 10;
        }

        /* Personagem e Elementos */
        #ayla { 
            width: 80px; height: 80px; position: absolute; z-index: 100; 
            margin-bottom: -8px; /* Ajuste para o p√© encostar no verde */
        }
        #ayla img { width: 100%; height: 100%; object-fit: contain; }

        .platform { position: absolute; background: #8B4513; border: 3px solid #5D2E0A; border-radius: 10px; z-index: 5; }
        .enemy { width: 65px; height: 65px; position: absolute; z-index: 90; margin-bottom: -5px; }
        .enemy img { width: 100%; height: 100%; object-fit: contain; }
        .star { position: absolute; width: 35px; height: 35px; z-index: 50; }

        /* Interface Mobile */
        #ui {
            position: fixed; top: 15px; left: 15px; right: 15px;
            display: flex; justify-content: space-between;
            color: #ff1493; font-size: 20px; font-weight: bold;
            text-shadow: 2px 2px white; z-index: 1000;
        }

        /* Bot√µes de Controle */
        #controls {
            position: fixed; bottom: 20px; left: 0; width: 100%;
            display: flex; justify-content: space-between; padding: 0 25px;
            z-index: 2000; pointer-events: none;
        }
        .ctrl-btn {
            width: 75px; height: 75px; background: rgba(255, 255, 255, 0.4);
            border: 4px solid #FFB6C1; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-size: 35px; pointer-events: auto; user-select: none;
        }
        .move-group { display: flex; gap: 20px; }

        /* Telas */
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 5000; color: white;
        }
        .btn-start { padding: 15px 40px; font-size: 24px; background: #ff1493; color: white; border: none; border-radius: 20px; cursor: pointer; }
        .facing-left { transform: scaleX(-1); }
    </style>
</head>
<body>

<div id="game-container">
    <div id="ui">
        <div>‚≠ê <span id="score">0</span> | ‚ù§Ô∏è <span id="lives">3</span></div>
        <div>üèÜ Recorde: <span id="high-score">0</span></div>
    </div>

    <div id="start-screen" class="overlay">
        <h1 style="color: #FFB6C1; font-size: 40px;">Ayla Adventure</h1>
        <button class="btn-start" onclick="startGame()">JOGAR</button>
    </div>

    <div id="game-over" class="overlay" style="display:none;">
        <h1 style="color: red;">Fim de Jogo</h1>
        <div id="ranking" style="color: gold; margin-bottom: 20px;"></div>
        <button class="btn-start" onclick="location.reload()">Tentar de Novo</button>
    </div>

    <div id="world">
        <div id="parallax-bg"></div>
        <div id="ground"></div>
        <div id="ayla"><img src="imagens/ayla-personagem.png"></div>
    </div>
</div>

<div id="controls">
    <div class="move-group">
        <div class="ctrl-btn" id="btnLeft">‚¨ÖÔ∏è</div>
        <div class="ctrl-btn" id="btnRight">‚û°Ô∏è</div>
    </div>
    <div class="ctrl-btn" id="btnJump">‚¨ÜÔ∏è</div>
</div>

<script>
    const world = document.getElementById('world');
    const ayla = document.getElementById('ayla');
    const ground = document.getElementById('ground');
    const scoreEl = document.getElementById('score');
    const livesEl = document.getElementById('lives');
    const highScoreEl = document.getElementById('high-score');

    let player = { x: 100, y: 80, velX: 0, velY: 0, isGrounded: true, lives: 3, score: 0, invencivel: false };
    let cameraX = 0, lastGenX = 500, gameActive = false, keys = {};

    // Recordes
    let highScore = localStorage.getItem('aylaHighScore') || 0;
    highScoreEl.innerText = highScore;

    // Ajuste de Toque para Mobile
    const handleTouch = (id, key) => {
        const btn = document.getElementById(id);
        btn.addEventListener('touchstart', (e) => { e.preventDefault(); keys[key] = true; });
        btn.addEventListener('touchend', (e) => { e.preventDefault(); keys[key] = false; });
    };
    handleTouch('btnLeft', 'ArrowLeft');
    handleTouch('btnRight', 'ArrowRight');
    handleTouch('btnJump', 'Space');

    // Suporte para Teclado
    window.onkeydown = e => keys[e.code] = true;
    window.onkeyup = e => keys[e.code] = false;

    function startGame() {
        document.getElementById('start-screen').style.display = 'none';
        gameActive = true;
        gameLoop();
    }

    function spawnElements() {
        if (lastGenX < player.x + 1000) {
            // Plataformas espor√°dicas
            if (Math.random() > 0.6) {
                let p = document.createElement('div');
                p.className = 'platform';
                p.style.left = lastGenX + 'px';
                p.style.bottom = (180 + Math.random() * 80) + 'px';
                p.style.width = '130px'; p.style.height = '20px';
                world.appendChild(p);
            }
            // Inimigos (Capanga ou Bowser)
            if (Math.random() > 0.6) {
                let e = document.createElement('div');
                e.className = 'enemy';
                e.style.left = (lastGenX + 500) + 'px';
                e.style.bottom = '80px';
                const isBowser = Math.random() > 0.8;
                e.innerHTML = `<img src="imagens/${isBowser ? 'bowse.jpg' : 'capanga.jpg'}">`;
                e.dataset.type = isBowser ? "bowser" : "capanga";
                world.appendChild(e);
            }
            // Estrelas
            let s = document.createElement('div');
            s.className = 'star';
            s.style.left = (lastGenX + 200) + 'px';
            s.style.bottom = (150 + Math.random() * 150) + 'px';
            s.innerHTML = `<svg viewBox="0 0 20 20"><polygon points="10,0 13,7 20,7 15,12 17,20 10,15 3,20 5,12 0,7 7,7" fill="yellow" stroke="#000"/></svg>`;
            world.appendChild(s);
            lastGenX += 700;
        }
    }

    function gameLoop() {
        if (!gameActive) return;
        if (player.lives <= 0) {
            gameActive = false;
            document.getElementById('game-over').style.display = 'flex';
            if (player.score > highScore) localStorage.setItem('aylaHighScore', player.score);
            return;
        }

        // Movimento
        if (keys['ArrowRight'] || keys['KeyD']) { player.velX = Math.min(player.velX + 0.6, 7); ayla.classList.remove('facing-left'); }
        else if (keys['ArrowLeft'] || keys['KeyA']) { player.velX = Math.max(player.velX - 0.6, -7); ayla.classList.add('facing-left'); }
        else { player.velX *= 0.85; }

        if ((keys['Space'] || keys['ArrowUp'] || keys['KeyW']) && player.isGrounded) { player.velY = 16; player.isGrounded = false; }

        player.velY -= 0.8; player.x += player.velX; player.y += player.velY;

        // Ch√£o fixo em 80px
        if (player.y <= 80) { player.y = 80; player.velY = 0; player.isGrounded = true; }

        // Colis√£o com Plataformas
        let onPlat = false;
        document.querySelectorAll('.platform').forEach(p => {
            let pb = parseInt(p.style.bottom), pl = parseInt(p.style.left), pw = parseInt(p.style.width);
            if (player.velY <= 0 && player.x + 50 > pl && player.x + 20 < pl + pw && player.y >= pb + 10 && player.y <= pb + 30) {
                player.y = pb + 20; player.velY = 0; player.isGrounded = true; onPlat = true;
            }
        });
        if (!onPlat && player.y > 80) player.isGrounded = false;

        // C√¢mera e Posi√ß√£o
        cameraX = Math.max(0, player.x - window.innerWidth/3);
        ayla.style.left = player.x + 'px';
        ayla.style.bottom = player.y + 'px';
        world.style.transform = `translateX(${-cameraX}px)`;
        ground.style.transform = `translateX(${cameraX}px)`;
        ground.style.backgroundPositionX = `${-cameraX}px`;

        spawnElements();

        // Inimigos e Estrelas
        document.querySelectorAll('.enemy, .star').forEach(obj => {
            let rObj = obj.getBoundingClientRect(), rAy = ayla.getBoundingClientRect();
            if (!(rAy.right < rObj.left || rAy.left > rObj.right || rAy.bottom < rObj.top || rAy.top > rObj.bottom)) {
                if (obj.classList.contains('star')) {
                    player.score++; scoreEl.innerText = player.score; obj.remove();
                } else if (!player.invencivel) {
                    player.lives--; livesEl.innerText = player.lives; player.invencivel = true; ayla.style.opacity = "0.5";
                    setTimeout(() => { player.invencivel = false; ayla.style.opacity = "1"; }, 2000);
                }
            }
            if (obj.classList.contains('enemy')) {
                let ex = parseInt(obj.style.left);
                if (ex < cameraX + window.innerWidth) {
                    let spd = obj.dataset.type === "bowser" ? 3.5 : 2;
                    obj.style.left = (ex + (ex > player.x ? -spd : spd)) + 'px';
                }
            }
        });

        requestAnimationFrame(gameLoop);
    }
</script>
</body>
</html>



